> [Back to Post-Merge Hardening Index](../post-merge-hardening.md) | [Legitimate Gaps](../post-merge-hardening.md#legitimate-gaps-status)

## Post-Merge Hardening (Feb 20 sync 4) — 14 upstream commits

**Merge commit:** 7ce357ff8 | **Range:** 62bc3227f..7ce357ff8

**Security relevance: LOW** — 2 security-relevant commits: hono dependency bump for timing-safe auth hardening, and Docker base image SHA256 digest pinning for supply chain security. No audit claims newly addressed; both commits strengthen existing defense-in-depth controls.

### Security-Relevant Commits

1. **`ce2a39a27`** — **Security: bump hono for timing-safe auth hardening:** Adds `"hono": "4.11.10"` package override in `package.json`. Hono is the web framework used in the gateway for HTTP routing and auth middleware. The bump ensures timing-safe authentication handling is in place. **Strengthens Claim 15** (timing-safe comparison) by ensuring the HTTP framework layer uses constant-time auth checks. Files: 2 prod + 1 doc.

2. **`8ae2d5110`** — **fix(docker): pin base images to SHA256 digests (#7734):** Pins all 9 Dockerfiles to immutable SHA256 digests, preventing supply chain attacks where a compromised upstream tag could silently pull attacker-controlled content. Also adds `.github/dependabot.yml` Docker ecosystem configuration for automated digest updates. Images pinned: `node:22-bookworm`, `node:22-bookworm-slim`, `debian:bookworm-slim`, `ubuntu:24.04`. New `src/docker-image-digests.test.ts` provides regression coverage. **Addresses Claim 16** (supply chain/package integrity) — closes the tag-mutable image pull vector. Files: 10 prod + 1 test.

### Non-Security Commits

| SHA | Message | Files |
|-----|---------|-------|
| `e98ccc8e1` | iOS/Gateway: stabilize background wake and reconnect behavior (#21226) | 7 prod + 1 test + 2 doc |
| `c2876b69f` | feat(auto-reply): add model fallback lifecycle visibility in status, verbose logs, and WebUI (#20704) | 16 prod + 7 test + 1 doc |
| `2af3415fa` | fix: treat HTTP 503 as failover-eligible for LLM provider errors (#21086) | 2 prod + 2 test |
| `bbcb3ac6e` | fix(slack): pass recipient_team_id to streaming API calls (#20988) | 2 prod |
| `20004711d` | fix(update): restart daemon after service refresh | 1 prod + 1 test |
| `82a174133` | fix: update formula handling in SKILL.md and frontmatter.ts (#11046) | 1 prod + 1 doc |
| `6ef365d06` | resolved bug with doing a raw call to anthropic compatible apis (#21336) | 1 prod |
| `f66b23de7` | chore(release): bump versions to 2026.2.20 | 40 prod + 1 doc |
| `4883aa543` | docs(changelog): credit prior Slack recipient-id groundwork for 20988 (#21434) | 1 doc |
| `2c93f6656` | Docs: record PR #21336 anthropic onboarding fix | 1 doc |
| `6cdcb5904` | chore: update changelog for merged fixes 7734 and 21086 (#21254) | 1 doc |
| `7ce357ff8` | docs: add Vincent Koc to contributor credits | 2 doc |

### Audit Cross-Reference

**Claims affected:** Claim 15 (timing-safe comparison) — strengthened by hono bump. Claim 16 (supply chain) — strengthened by Docker digest pinning.

**Unaffected claims:** Claims 1–14 unaffected. Three legitimate gaps (pipe-delimited token format, outPath validation, bootstrap/memory .md scanning) remain open.

### Line Shifts

- `src/agents/pi-embedded-helpers/errors.ts`: `ERROR_PATTERNS.timeout` array start shifted `:580` → `:592`; regex `/without sending (?:any )?chunks?/i` now at `:597` (due to `overloaded` array expansion in `2af3415fa`). Updated in sync-14.md.
- `src/agents/skills/frontmatter.ts`: `disable-model-invocation` parsing shifted `:103` → `:109` (due to formula/cask fallback expansion in `82a174133`). Updated in ai-self-misconfiguration.md and operational-gotchas.md.
- `src/auto-reply/reply/agent-runner-execution.ts`: `runAgentTurnWithFallback` export start now at `:67` (was `:~103` inside function body; new type definitions added by `c2876b69f` shifted function start). Updated in resource-usage.md.
- `src/gateway/server-methods/nodes.ts`: `system.execApprovals` blocking check shifted `:371-381` → `:587-598` (due to iOS/Gateway wake expansion of ~219 lines in `e98ccc8e1`). Updated in sync-7.md and 11-security-audit-analysis.md.

### Feature Changes (Phase 5c)

- `c2876b69f feat(auto-reply)`: New files `src/auto-reply/fallback-state.ts` and `src/auto-reply/model-runtime.ts` add model fallback lifecycle tracking (`RuntimeFallbackAttempt` type). Visible in status output and WebUI. No immediate doc update needed; flag for next align-docs-upstream run.

**Gap status: 1 closed, 3 remain open** (pipe-delimited token format, outPath validation, bootstrap/memory .md scanning — unchanged) — see [Legitimate Gaps Status](../post-merge-hardening.md#legitimate-gaps-status).
