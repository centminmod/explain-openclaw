> [Back to Post-Merge Hardening Index](../post-merge-hardening.md) | [Legitimate Gaps](../post-merge-hardening.md#legitimate-gaps-status)

## Feb 19 Sync 1 (41 commits)

**Merge commit:** 3af9f704c | **Range:** 66248599d..3af9f704c

### Security-Relevant Commits

| SHA | Message | Files | Description |
|-----|---------|-------|-------------|
| `1437ed76a` | Gateway/CLI: add paired-device remove and clear flows (#20057) | 9 prod + 3 test + 1 doc | Extends device pairing with removal and bulk-clear operations. See lines below. Strengthens Claim 5 (gateway method authorization). |

**`1437ed76a` details:**
- `src/gateway/server-methods.ts:50` — adds `device.pair.remove` to PAIRING_METHODS set
- `src/infra/device-pairing.ts:324` — adds new `removePairedDevice()` function
- `src/cli/devices-cli.ts:200` — adds `devices remove` CLI command
- `src/cli/devices-cli.ts:221` — adds `devices clear` CLI command
| `114736ed1` | Doctor/Security: fix telegram numeric ID + symlink config permission warnings (#19844) | 6 prod + 2 test | Two security audit improvements: (1) `isNumericTelegramUserId()` at `src/channels/telegram/allow-from.ts:9` now accepts negative group IDs with regex `/^-?\d+$/`, fixing allowlist validation for Telegram supergroups. (2) Security audit now skips world/group readable warnings for symlinked config files (`src/security/audit.ts:189-226`) to reduce false positives when config is a symlink to a secure location. Improves Claim 9 (file permissions) accuracy. |

### Non-Security Commits

| SHA | Message | Files | Reason |
|-----|---------|-------|--------|
| `ff50d3303` | test(memory): dedupe model-auth mock setup | 3 test | Test-only refactoring: extracts repeated mock setup into shared helper |
| `e1b491d96` | test(channels): dedupe inbound contract dispatch capture setup | 1 prod + 2 test | Test-only refactoring: extracts test helper into `test/helpers/` |
| `cb34e80f9` | fix(ios): restore auto-selected team for local signing (#19993) | 5 prod + 1 doc | iOS build configuration only, no security logic |
| `28b8101ee` | fix(browser): handle IPv6 loopback auth and dedupe fetch auth tests | 1 prod + 1 test | Bug fix for IPv6 `[::1]` URL parsing, auth logic unchanged |
| `d833dcd73` | fix(telegram): cron and heartbeat messages land in wrong chat instead of target topic (#19367) | 5 prod + 4 test + 2 doc | Feature/bug fix for topic delivery routing, no auth changes |

### Audit Cross-Reference

**Affected Claims:**
- **Claim 5 (Gateway method authorization):** `1437ed76a` adds new `device.pair.remove` to the protected PAIRING_METHODS set, maintaining RBAC consistency for device management operations.
- **Claim 9 (File permissions):** `114736ed1` refines security audit to avoid false-positive warnings for symlinked config files. The symlink itself may have permissive permissions while the target file is secure — the audit now checks the target's permissions.
- **Claim 13 (Device pairing flow):** `1437ed76a` extends device pairing capabilities with removal and bulk-clear operations, following the existing authorization patterns.

**Unaffected Claims:** Claims 1-4, 6-8, 10-12, 14-16, and all 3 legitimate gaps remain unchanged.

**Gap status: 1 closed, 3 remain open.** — see [Legitimate Gaps Status](../post-merge-hardening.md#legitimate-gaps-status).
