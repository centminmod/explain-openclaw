> [Back to Post-Merge Hardening Index](../post-merge-hardening.md) | [Legitimate Gaps](../post-merge-hardening.md#legitimate-gaps-status)

## Post-Merge Hardening (Feb 10 sync 3, 26 upstream commits)

Primarily CI infrastructure (code-size gates, tiered lint/format), extension TypeScript fixes, and test coverage expansion. One security-relevant fix:

**LOW — Access control correctness (1):**

- **`29425e27e`** (PR [#12779](https://github.com/openclaw/openclaw/issues/12779), thanks @liuxiaopai-ai) — **fix(telegram): match DM allowFrom against sender user id:** DM access control previously used `chatId` as the `allowFrom` match key. For Telegram DMs, `allowFrom` entries are typically user IDs (`msg.from.id`) or `@usernames`. Using `chatId` caused legitimate DMs to be rejected. Now matches against `msg.from.id` with `chatId` fallback (`src/telegram/bot-message-context.ts:277-282`, line refs updated after Feb 21 sync 2 refactor). Regression tests added in `a77afe618`.

**Other notable changes:**

- **`2e4334c32`** — **test(auth): cover key normalization:** 222 new test lines covering API key normalization across MiniMax VLM, Firecrawl web-fetch, skills.update, and provider-usage auth paths. Increases confidence in credential handling correctness.

- **`512b2053c`** (PR [#12795](https://github.com/openclaw/openclaw/pull/12795)) — **fix(web_search): Fix invalid model name sent to Perplexity:** Strips `perplexity/` prefix from model names when sending directly to `api.perplexity.ai`. Adds `resolvePerplexityRequestModel()` and `isDirectPerplexityBaseUrl()` functions, shifting all line numbers in `src/agents/tools/web-search.ts` by +21 below line 283.

**Line number shifts in this sync:** `src/agents/tools/web-search.ts` +21 lines at line 283 (Perplexity model resolution functions inserted). References updated: `wrapWebContent` 509,580,582→530,601,603; X-Title 390→411; Brave headers 558-563→579-584; Grok fetch 442-448→463-469.

**CVE status:** 5 published advisories — all pre-existing, none patched in this merge.

**Gap status: 1 closed, 3 remain open** (pipe-delimited token format, outPath validation — Gap #3 partially mitigated by default-deny on `screen.record`, bootstrap/memory .md scanning) — see [Legitimate Gaps Status](../post-merge-hardening.md#legitimate-gaps-status).
