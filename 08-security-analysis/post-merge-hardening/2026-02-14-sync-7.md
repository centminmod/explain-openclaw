> [Back to Post-Merge Hardening Index](../post-merge-hardening.md) | [Legitimate Gaps](../post-merge-hardening.md#legitimate-gaps-status)

## Feb 14 sync 7 (7 commits)

**Merge commit:** `4225206f0` | **Range:** `31537c669..4225206f0`

Small batch with one security-relevant session archival feature plus performance improvements and documentation fixes. No new vulnerabilities addressed.

### Moderate: Session Transcript Archival

- **`31537c669`** (PR [#14949](https://github.com/openclaw/openclaw/pull/14949)) — **Archive old transcript files on /new and /reset:** Previously, `/new` and /reset` commands created fresh sessions but left old transcript files orphaned on disk. Now exports and calls `archiveSessionTranscripts()` to move stale files to `.archive/` subdirectory with timestamp prefix. Files: `src/gateway/session-utils.ts` (export added), `src/gateway/session-utils.fs.ts` (implementation), `src/gateway/server-methods/sessions.ts` (invocation), `src/auto-reply/reply/session.ts` (import), `src/gateway/sessions-resolve.ts` (import), plus test updates. No security impact—operational hygiene only.

### Other Changes (Not Security-Relevant)

- **`c8b198ab5`** — Speed up gateway missing-tick e2e watchdog (test-only)
- **`e746a67cc`** — Speed up telegram media e2e flush timing (test-only)
- **`bbca3b191`** — Changelog: add missing attribution
- **`8c1e8bb2f`** (PR [#15501](https://github.com/openclaw/openclaw/pull/15501)) — Note clawdock zsh compatibility (documentation)
- **`66f6d71ff`** — Update clawdock-helpers.sh compatibility with Zsh (script helper)
- **`f24d70ec8`** (PR [#15297](https://github.com/openclaw/openclaw/pull/15297)) — Switch MiniMax API-key provider to anthropic-messages format

### Line Number Shifts

Major refactoring in `bash-tools.exec.ts` and `node-host/runner.ts` (844 and 1150 lines extracted to new modules):

| File | Old Reference | New Reference | Reason |
|------|--------------|---------------|--------|
| `src/agents/bash-tools.exec.ts` | `:61-78` | `src/agents/bash-tools.exec-runtime.ts:32-86` | `DANGEROUS_HOST_ENV_VARS` extracted to runtime module |
| `src/agents/bash-tools.exec.ts` | `:955-962` | `src/agents/bash-tools.exec-runtime.ts:237-244` | `elevatedMode` handling moved |
| `src/agents/bash-tools.exec.ts` | `:972` | `src/agents/bash-tools.exec-runtime.ts:237` | `baseEnv` reference |
| `src/agents/bash-tools.exec.ts` | `:976-977` | `src/infra/exec-approvals-allowlist.ts:1-296` | `validateHostEnv` extracted to allowlist module |
| `src/agents/bash-tools.exec.ts` | `:982-991` | `src/infra/exec-approvals-allowlist.ts:41-200` | `params.env` merge and validation logic extracted |
| `src/agents/bash-tools.exec.ts` | `:1278` | `src/agents/bash-tools.exec-runtime.ts:358` | `bypassApprovals` reference |
| `src/node-host/runner.ts` | `:166-175` | `src/node-host/invoke.ts:44-174` | `blockedEnvKeys`/`blockedEnvPrefixes` extracted to invoke module |
| `src/infra/exec-approvals.ts` | `:110-161` | `src/infra/exec-approvals-allowlist.ts:1-296` | `authorizeGatewayMethod` extraction to new module |
| `src/infra/exec-approvals.ts` | `:73-97` | `src/infra/exec-approvals-allowlist.ts:157-197` | `resolveExecApprovals` extracted |
| `src/infra/exec-approvals.ts` | `:454-506` | `src/infra/exec-approvals-analysis.ts:1-200` | Command analysis functions extracted |

### Commit Chains

No related commit chains detected in this sync batch.

**Gap status:** No change — see [Legitimate Gaps Status](../post-merge-hardening.md#legitimate-gaps-status).
