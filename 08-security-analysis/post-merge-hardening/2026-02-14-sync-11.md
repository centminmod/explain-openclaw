> **Navigation:** [Post-merge Hardening Index](../post-merge-hardening.md) | [Main Guide](../../README.md)

# Post-Merge Hardening — Feb 14 sync 11 (18 commits)

**Merge commit:** `56534c1e7` — Merge upstream openclaw/main (Feb 14 sync 11)
**Parent range:** `f8f37203e..a50638eea`

## Security-Relevant Commits

### 1. `45e12d238` (PR [#16002](https://github.com/openclaw/openclaw/pull/16002)) — bluebubbles: gracefully handle disabled private API with action/tool filtering and fallbacks

**Files (12):** `extensions/bluebubbles/src/actions.ts`, `actions.test.ts`, `attachments.ts`, `attachments.test.ts`, `chat.ts`, `chat.test.ts`, `monitor-processing.ts`, `monitor.ts`, `probe.ts`, `reactions.ts`, `send.ts`, `send.test.ts`

**Security relevance: LOW-MEDIUM.** When the BlueBubbles Private API is disabled, the extension now gracefully filters out actions that require it (react, edit, unsend, reply, sendWithEffect, renameGroup, setGroupIcon, addParticipant, removeParticipant, leaveGroup) rather than exposing them as available. Runtime guards (`assertPrivateApiEnabled()`) throw explicit errors if somehow invoked. This is a defense-in-depth improvement — prevents the agent from advertising capabilities it cannot fulfill, reducing error surface.

**Hardening pattern:** The `getCachedBlueBubblesPrivateApiStatus()` probe caches the server's Private API status and is checked both at action listing time (filters unavailable actions) and at execution time (throws if disabled). `chat.ts` silently returns for read-receipt and typing indicators when Private API is off, preventing unnecessary API calls.

### 2. `d8beddc8b` — refactor(onboard): unify auth-choice aliases and provider flags

**Files (9):** `src/cli/program/register.onboard.ts`, `src/commands/auth-choice-legacy.ts` (NEW), `src/commands/auth-choice-options.ts`, `src/commands/auth-choice-options.e2e.test.ts`, `src/commands/onboard-non-interactive.provider-auth.e2e.test.ts`, `src/commands/onboard-non-interactive/local/auth-choice-inference.ts`, `src/commands/onboard-provider-auth-flags.ts` (NEW), `src/commands/onboard-types.ts`, `src/commands/onboard.ts`

**Security relevance: LOW.** Refactoring consolidation — legacy auth choice aliases extracted to `auth-choice-legacy.ts`, provider API key flags unified in `onboard-provider-auth-flags.ts`. No behavioral changes to authentication logic. Adds Chutes as a new auth choice group (OAuth). The `ONBOARD_PROVIDER_AUTH_FLAGS` array centralizes all provider API key flag definitions, reducing risk of inconsistency.

### 3. NVIDIA provider chain (7 commits)

- `c640b5f86` — feat: add NVIDIA API provider integration
- `8f2884b98` — fix: fixing changes (adds `nvidia: "NVIDIA_API_KEY"` to `src/agents/model-auth.ts:308`)
- `ae8be6ac2` — fix: linting (docs/providers/index.md)
- `f90a39e98`, `3feb5d1f1`, `e0132514f` — formatting/linting fixes
- `fdda26147` (PR [#11606](https://github.com/openclaw/openclaw/pull/11606)) — fix: align NVIDIA provider docs and model ids

**Security relevance: LOW.** New NVIDIA API provider with `NVIDIA_API_KEY` environment variable in `src/agents/model-auth.ts:308`. Provider config in `src/agents/models-config.providers.ts` follows existing pattern. New test file `src/agents/models-config.providers.nvidia.test.ts`. No new attack surface beyond standard API key handling.

### 4. `98bb4225f` — perf(test): minimize gateway startup in vitest

**Files:** `src/gateway/server.impl.ts`, `src/gateway/test-helpers.server.ts`

**Security relevance: NONE for production.** Adds a `VITEST=1 && OPENCLAW_TEST_MINIMAL_GATEWAY=1` guard that skips plugin loading, discovery, heartbeat, and other subsystems during tests. The guard is double-gated (both env vars required) and only affects test environments. Production code paths unchanged.

## Non-Security Commits

| SHA | Description |
|-----|-------------|
| `a50638eea` | perf(test): disable vector index in OpenAI batch tests |
| `0e5e72edb` | perf(test): shrink memory embedding batch fixtures |
| `db72184de` | perf(test): speed up Matrix send tests |
| `2f4cef202` | perf(test): remove last-route polling in partial reply gating |
| `4335668d2` | chore(test): fix cron every-jobs-fire unused import |
| `e6d5b5fb1` | perf(test): remove slow port inspection and reconnect sleeps |
| `1f432ffb9` | docs(changelog): clarify Hugging Face support in 2026.2.13 |
| `eab9dc538` | refactor(onboard): unify auth-choice catalog for CLI help |

## Line Number Shifts

**`src/gateway/server.impl.ts`** — +56 net lines (193 insertions, 137 deletions) due to test-minimal gateway refactor:
- Bind policy documentation: old `:107` → `:112-118`
- Rate limiter creation: old `:275-277` → `:301-304`
- Plugin loading block restructured with conditional test bypass at `:239-265`

**`src/agents/models-config.providers.ts`** — +54 lines (NVIDIA provider models added at end of file):
- Ollama constants at `:83-92` — unchanged from previous sync

**`extensions/bluebubbles/src/attachments.ts`** — +12 lines:
- `sanitizeFilename()` at `:27-33` (was `:26-30`, expanded with CWE-93 strip logic)
- `addFile()` Content-Disposition at `:228-235` (was `:224-228`)

**`extensions/bluebubbles/src/chat.ts`** — +42 lines:
- Content-Disposition with sanitization at `:362-368` (was `:340-342`)

## Documentation Updates

- `explain-clawdbot/08-security-analysis/cisco-ai-defense-skill-scanner.md`: Updated `server.impl.ts:107` → `:112-118` (2 occurrences)
- `explain-clawdbot/08-security-analysis/open-upstream-prs.md`: Updated `server.impl.ts:275-277` → `:301-304`

## CVE/GHSA Coverage

No CVE or GHSA references in this merge.

## Phase Completion Self-Check

- [x] Phase 1: Merge parents verified via `git cat-file -p` — `f8f37203e` and `a50638eea`
- [x] Phase 1: Commit count verified via `git rev-list --count` — 18 commits
- [x] Phase 2: All source references cataloged from explain-clawdbot/**/*.md
- [x] Phase 3: Changed files cross-referenced with doc references
- [x] Phase 4: Line numbers verified for `server.impl.ts`, `models-config.providers.ts`, `attachments.ts`, `chat.ts`
- [x] Phase 5: All 18 commits analyzed for security relevance
- [x] Phase 5b: Per-commit `git diff-tree` audit completed for all 18 commits
- [x] Phase 5c: Commit chains identified (NVIDIA: 7 commits, onboard auth: 2 commits)
- [x] Phase 6: Cross-referenced with existing audit findings
- [x] Phase 6c: CVE/GHSA check — none in this merge
- [x] Phase 7: Line number references updated in 2 documentation files
- [x] Phase 8: This self-check completed
