> [Back to Post-Merge Hardening Index](../post-merge-hardening.md) | [Legitimate Gaps](../post-merge-hardening.md#legitimate-gaps-status)

## Feb 19 Sync 7 (21 commits)

**Merge commit:** 6b05916c1 | **Range:** d73501887..6b05916c1

**Security relevance: LOW** — 4 security-adjacent refactors extracting shared helpers in security modules. No new controls or hardening. All changes are code consolidation improving maintainability.

### Security-Adjacent Refactors (4)

| SHA | Message | Files | Description |
|-----|---------|-------|-------------|
| `d6768098a` | refactor(security): share installed plugin directory scan helper | 1 prod + 0 test | Extracts `listInstalledPluginDirs()` to `src/security/audit-extra.async.ts:99`, consolidating duplicate directory enumeration logic in `collectPluginsTrustFindings()` and `collectPluginsCodeSafetyFindings()`. Indirectly supports Claims 5-6. |
| `c8bdefd8b` | refactor(security): reuse shared scan path containment helper | 1 prod + 0 test | Removes local duplicate of `isPathInside()` in favor of importing from `src/security/scan-paths.ts:3`. Used at `src/security/skill-scanner.ts:301` for root containment check. Supports Claim 6 (path traversal). |
| `989c9dbd3` | refactor(auth): share remaining-time formatter | 2 prod + 1 test | Extracts `formatRemainingShort()` to `src/agents/auth-health.ts:46`, consolidating time formatting between auth-health and directive-handling.auth. Display logic only, no enforcement. |
| `5c5c032f4` | refactor(security): share DM allowlist state resolver | 3 prod + 1 test | Extracts `resolveDmAllowState()` to new `src/security/dm-policy-shared.ts:5`, centralizing DM allowlist normalization. Used by `doctor-security.ts:87` and `audit-channel.ts:67`. Supports channel security policy. |

### Non-Security Commits (3 flagged + 14 safe = 17 total)

| SHA | Message | Files | Reason |
|-----|---------|-------|--------|
| `6b05916c1` | fix: gate Telegram exec tool warnings behind verbose mode (#20560) | 2 prod + 3 test + 1 doc | UX improvement — hides exec tool warnings unless verbose |
| `2bb8ead18` | Fix LaunchAgent missing TMPDIR causing SQLITE_CANTOPEN on macOS (#20512) | 1 prod + 2 test + 1 doc | Bug fix — forwards TMPDIR env to LaunchAgent services |
| `c2b6f099c` | fix(agents): update SUBAGENT_SPAWN_ACCEPTED_NOTE to clarify response type | 1 prod + 0 test | Docstring typo fix — "agent message" → "user message" |

**Safe commits (14):** Config refactors (`e426a9bb6`, `6ae7e6fd1`), Discord dedupe (`2dd361c07`), CLI dedupe (`ac4419095`), hooks dedupe (`ae2e6896d`), chunker dedupe (`aee002a39`), model fallback (`ef5d7cee2`), forward-compat test/resolve (`8e1f25631`, `cb9e09855`), payload types (`8b17a369e`), daemon output (`2709c0ba5`), PR skills polish (`b228c06bb`), billing error format (`3d4ef5604`), entry status (`b2c273745`).

### Audit Cross-Reference

**Affected Claims:** None directly. All 4 security-adjacent commits are refactors that:
- **Claim 5-6:** `d6768098a` indirectly supports by centralizing plugin scanning
- **Claim 6:** `c8bdefd8b` indirectly supports by consolidating path containment
- **Claim 8:** `989c9dbd3` is display logic, no enforcement change
- **Channel security:** `5c5c032f4` consolidates DM allowlist evaluation

**Unaffected Claims:** Claims 1-4, 7, 9-16, and all 3 legitimate gaps unchanged.

**Gap status: 1 closed, 3 remain open.** — see [Legitimate Gaps Status](../post-merge-hardening.md#legitimate-gaps-status).
