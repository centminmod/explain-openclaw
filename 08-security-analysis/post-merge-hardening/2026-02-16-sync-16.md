> [Back to Post-Merge Hardening Index](../post-merge-hardening.md) | [Legitimate Gaps](../post-merge-hardening.md#legitimate-gaps-status)

## Post-Merge Hardening (Feb 16 sync 16, 102 upstream commits)

**Merge commit:** 7a4c131d6 | **Range:** b434b6a28..7a4c131d6

This batch contains 0 security-relevant commits. All 14 initially-flagged commits were test file removals incorrectly flagged due to security keywords in test names (e.g., "traversal", "guard", "prune"). After triage review, all were demoted to SAFE.

### Non-Security Commits

| SHA | Message | Files | Reason |
|-----|---------|-------|--------|
| `b6a9741ba` | refactor(telegram): simplify send/dispatch/target handling (#17819) | 16 production | Code reorganization, no behavior change |
| `314f19303` | fix(ci): run scope detection on blacksmith runners | 1 production | CI infrastructure |
| `1e4cf489e` | fix(ci): keep main runs alive while coalescing newer pushes | 5 production | CI concurrency |
| `ada7a6289` | fix(ci): dedupe docker release runs by ref | 1 production | CI infrastructure |
| `2983ef024` | fix(ci): use ref-based concurrency across workflows | 3 production | CI infrastructure |
| `025d4152d` | fix(ci): key concurrency by ref instead of sha | 1 production | CI infrastructure |
| `3daaa1942` | fix(ci): use JDK 17 for Android SDK setup | 1 production | CI infrastructure |
| `7a4c131d6` + 94 more | test: remove low-value/redundant test cases | 88 test | Test cleanup |

### Notable Changes

**Telegram refactor** (`b6a9741ba`): Extracted group access control logic into new module `src/telegram/group-access.ts` (141 lines). Created two new functions:
- `evaluateTelegramGroupBaseAccess()` (lines 20-58) — handles group/topic disabled checks and allowFrom override authorization
- `evaluateTelegramGroupPolicyAccess()` (lines 75-141) — handles group policy enforcement (open/disabled/allowlist)

This is a pure refactor — no security behavior changed, just code organization for maintainability. Deleted two obsolete files: `src/telegram/download.ts` (57 lines) and `src/telegram/webhook-set.ts` (41 lines).

**CI improvements**: Multiple commits improved GitHub Actions workflow efficiency by using ref-based concurrency keys instead of SHA-based, preventing duplicate runs when multiple pushes occur to the same branch.

### Line Number Updates

This sync updated stale references in historical entries due to the telegram refactor:

| File | Old Line | New Line | Context |
|------|----------|----------|---------|
| `src/telegram/bot/helpers.ts` | 69-82 | 74-86 | `resolveTelegramForumThreadId()` |
| `src/telegram/bot/helpers.ts` | 73-86 | 74-86 | Same function (Opus audit) |
| `src/telegram/bot-message-context.ts` | 231-233 | 267-272 | DM allowFrom matching (Feb 10 entry) |

### Audit Cross-Reference

**Unaffected Claims:** All 16 audit claims and 3 legitimate defense-in-depth gaps remain unchanged by this batch. The telegram refactor is code reorganization without security behavior modification.

- Claim 1 (Sandbox isolation): No changes
- Claim 2 (Command execution): No changes
- Claim 3 (File access): No changes
- Claim 4 (Network): No changes
- Claim 5 (RBAC): No changes
- Claim 6 (Approvals): No changes
- Claim 7 (Webhook validation): No changes
- Claim 8 (Env handling): No changes
- Claims 9-16: No changes

**Gap status:** 1 closed (gateway env blocklist), 3 open (pipe-delimited tokens, outPath validation, bootstrap/md scanning) — see [Legitimate Gaps Status](../post-merge-hardening.md#legitimate-gaps-status).

### CVE/GHSA Status

30 advisories found — all pre-existing, none patched in this merge.

**Gap status: 1 closed, 3 remain open** — see [Legitimate Gaps Status](../post-merge-hardening.md#legitimate-gaps-status).
