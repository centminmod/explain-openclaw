> [Back to Post-Merge Hardening Index](../post-merge-hardening.md) | [Legitimate Gaps](../post-merge-hardening.md#legitimate-gaps-status)

## Post-Merge Hardening (Feb 11 sync 2, 17 upstream commits)

**Merge commit:** `86aca131b` | **Range:** `05baacb2a..86aca131b`

**Security relevance: LOW** — no direct overlap with the 16 audit claims or 3 legitimate gaps. Five commits are security-adjacent (defense-in-depth improvements, new attack surface from IRC).

**Security-relevant commits (5):**

**MEDIUM (3):**

1. **`7f1712c1b`** (PR [#13455](https://github.com/openclaw/openclaw/pull/13455)) — **Enforce embedding model token limit to prevent overflow:** New `enforceEmbeddingMaxInputTokens()` in `src/memory/embedding-chunk-limits.ts` with per-model limits (`src/memory/embedding-model-limits.ts`). Uses UTF-8 byte length as conservative upper bound. Splits oversized chunks via binary search. Prevents DoS from oversized embedding inputs.

2. **`424d2dddf`** (PR [#13498](https://github.com/openclaw/openclaw/pull/13498)) — **Prevent act:evaluate hangs from blocking browser tool:** Clamps `evaluate()` timeout to 120s max in `src/browser/pw-tools-core.interactions.ts:235-246`. Injects `Promise.race` timeout into browser context. Adds abort signal handling for force-disconnect. Prevents DoS from runaway browser evaluations.

3. **`fa906b26a`** — **IRC first-class channel support:** New `extensions/irc/` with TLS client, NickServ auth, channel allowlisting (`extensions/irc/src/policy.ts`), case-insensitive matching, and control character sanitization. **New attack surface** — external network protocol exposure. TLS uses default Node.js cert validation.

**LOW (2):**

4. **`841dbeee0`** (PR [#13468](https://github.com/openclaw/openclaw/pull/13468)) — **Coerce form values to schema types before config.set:** New `ui/src/ui/controllers/config/form-coerce.ts` converts HTML form strings to proper types (number, boolean) before Zod validation. Prevents type confusion at Web UI → Gateway boundary.

5. **`ca629296c`** (PR [#13672](https://github.com/openclaw/openclaw/pull/13672)) — **Add agentId support to webhook mappings:** Extends `src/gateway/hooks.ts` and `src/gateway/server-http.ts` with per-mapping `agentId` fields and `hooks.allowedAgentIds` allowlist enforcement. New `isHookAgentAllowed()`, `resolveHookTargetAgentId()`. Positive: follows least privilege for webhook → agent routing.

**Other notable (non-security):**

- `2b02e8a7a` (PR [#10568](https://github.com/openclaw/openclaw/pull/10568)) — Gateway: stream thinking events and decouple tool events from verbose level
- `d2c2f4185` (PR [#13733](https://github.com/openclaw/openclaw/pull/13733)) — Heartbeat: inject current time into agent prompts
- `45488e4ec` (PR [#12102](https://github.com/openclaw/openclaw/pull/12102)) — Fix: remap session JSONL chunk line numbers to original source positions
- `74273d62d` (PR [#13723](https://github.com/openclaw/openclaw/pull/13723)) — Fix(pairing): show actual code in approval command instead of placeholder

**Line number shifts in this sync:** `runner.ts` +1 (165-174→166-175, new `withTimeout` import), `hooks.ts` +46 (46-63→92-109, 65-111→111-157, new types/agent policy functions/imports), `server-http.ts` +4/+18 (92-126→96-130, 150-157→154-161, 332→350, 356-376→374-394, 418-440→436-458), `manager.ts` refactored (2257-2354→2198-2301, session helpers extracted). All references updated in documentation.

**CVE status:** 5 published advisories — all pre-existing, none patched in this merge.

**Gap status: 1 closed, 3 remain open** (pipe-delimited token format, outPath validation — Gap #3 partially mitigated, bootstrap/memory .md scanning — Gap #4 strengthened by collection scoping) — see [Legitimate Gaps Status](../post-merge-hardening.md#legitimate-gaps-status).
