> [Back to Post-Merge Hardening Index](../post-merge-hardening.md) | [Legitimate Gaps](../post-merge-hardening.md#legitimate-gaps-status)

## Feb 16 Sync 11 Hardening (21 commits)

**Merge commit:** c95a61aa9 | **Range:** 89658168c..c95a61aa9

### Overview

This batch contains 21 upstream commits from openclaw/main. All commits are refactoring work to deduplicate code across gateway components, outbound services, and various plugins. No new security vulnerabilities were introduced, and no existing security controls were weakened. This is a code quality improvement batch only.

### Commits Table

| SHA | Message | Files | Security Relevant |
|-----|---------|-------|-------------------|
| c95a61aa9 | refactor(cron): dedupe read-only load flow | 1 | No |
| 260a51446 | refactor(slack): share channel config entry type | 2 | No |
| 067509fa4 | refactor(onboarding): dedupe WhatsApp owner allowlist | 1 | No |
| e84b20a52 | refactor(status-issues): share enabled/configured account gate | 3 | No |
| d5ee766af | refactor(outbound): dedupe channel handler params | 1 | No |
| 00c91c367 | refactor(outbound): dedupe queued delivery param types | 1 | No |
| 4ab25a288 | refactor(outbound): reuse message gateway call | 1 | No |
| 57d5a8df8 | refactor(outbound): dedupe directory list call | 1 | No |
| b6871d9c0 | refactor(outbound): dedupe attachment hydration | 1 | No |
| 753491ab8 | refactor(slack): dedupe outbound send flow | 1 | No |
| d00adfe98 | refactor(signal): dedupe outbound media limit resolve | 1 | No |
| 2b2c3a071 | refactor(imessage): dedupe outbound media limit resolve | 1 | No |
| 73a97ee25 | refactor(gateway): share node invoke error handling | 4 | No |
| b1dca644b | refactor(gateway): share restart request parsing | 3 | No |
| b743e652c | refactor(gateway): reuse shared validators + baseHash | 4 | No |
| 71cee673b | fix(gateway): satisfy server-method lint | 2 | No |
| dc5d23484 | refactor(gateway): share server-method param validation | 3 | No |
| a5cbd036d | refactor(gateway): dedupe wizard param validation | 1 | No |
| 4aaafe532 | refactor(net): share hostname normalization | 3 | No |
| 14fb2c05b | Gateway/Control UI: preserve partial output on abort | 9 | No |
| f03ea76db | fix(slack): tighten threadId type to satisfy lint | 1 | No |

### Analysis

All 21 commits in this batch are internal refactoring with no security implications:

- **Gateway refactors** (73a97ee25, b1dca644b, b743e652c, 71cee673b, dc5d23484, a5cbd036d): Extract shared validation and error handling functions into new modules (`nodes.helpers.ts`, `restart-request.ts`, `base-hash.ts`, `validation.ts`). No security boundary changes.

- **Network refactors** (4aaafe532): Extracts `normalizeHostname()` to `src/infra/net/hostname.ts`. SSRF protection logic in `ssrf.ts` unchanged functionally.

- **Outbound service refactors** (d5ee766af, 00c91c367, 4ab25a288, 57d5a8df8, b6871d9c0): Deduplicate parameter type definitions and gateway call patterns across delivery handlers.

- **Channel plugin refactors** (067509fa4, e84b20a52, 753491ab8, f03ea76db, d00adfe98, 2b2c3a071, 260a51446): Share types and helper functions across WhatsApp, status-issues (Discord/Telegram), Slack, Signal, and iMessage integrations.

- **UI improvements** (14fb2c05b): Chat abort persistence changes in web UI and gateway. No security implications.

- **Cron refactors** (c95a61aa9): Deduplicate read-only load flow in cron service.

### New Files Created (6)

- `src/gateway/chat-abort.test.ts` (test file)
- `src/gateway/server-methods/base-hash.ts` (8 lines, new function)
- `src/gateway/server-methods/chat.abort-persistence.test.ts` (test file)
- `src/gateway/server-methods/restart-request.ts` (20 lines, new function)
- `src/gateway/server-methods/validation.ts` (27 lines, new function)
- `src/infra/net/hostname.ts` (7 lines, new function)

### Audit Cross-Reference

**Unaffected Claims:** All 16 audit claims remain unaffected by this batch.

- **Claim 1 (Agent code execution):** No changes to paths.ts sandboxing
- **Claim 2 (SSRF via web-fetch):** `normalizeHostname()` extracted but functionality unchanged
- **Claim 3 (Agent self-approval):** Validation logic standardized but security boundaries maintained
- **Claim 4 (SSRF via message delivery):** No changes to outbound/message.ts security controls
- **Claim 5 (Node.invoke exec approvals):** Error handling improved but approval logic unchanged
- **Claim 6 (Session path traversal):** No changes to sessions/paths.ts
- **Claim 7 (Webhook auth bypasses):** No changes to channel-specific auth
- **Claim 8 (Shell metacharacter injection):** No changes to buildSafeShellCommand

### Security Impact

**Zero security-relevant commits.** This batch represents pure code quality improvements through deduplication. All refactoring maintains existing security boundaries and controls.

**Gap status:** Unchanged â€” see [Legitimate Gaps Status](../post-merge-hardening.md#legitimate-gaps-status).
