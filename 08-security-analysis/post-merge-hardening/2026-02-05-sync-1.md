> [Back to Post-Merge Hardening Index](../post-merge-hardening.md) | [Legitimate Gaps](../post-merge-hardening.md#legitimate-gaps-status)

## Post-Merge Notes (Feb 5 sync 1)

**New feature: Cloudflare AI Gateway provider** (`5b0851ebd`)

Commit `5b0851ebd` adds Cloudflare AI Gateway as a new provider option. This is not a security fix but provides security-adjacent benefits:

- **Cloudflare AI Gateway** is a forward proxy between OpenClaw and AI inference providers (Anthropic, OpenAI, etc.)
- Routes requests through: `https://gateway.ai.cloudflare.com/v1/<account_id>/<gateway_id>/anthropic`
- Provides: analytics, logging, caching, rate limiting, request retry/fallback
- Security benefits: Guardrails (content moderation), DLP (Data Loss Prevention), request auditing
- Configuration via `openclaw onboard --auth-choice cloudflare-ai-gateway-api-key`

Implementation details (verified via LSP/code review):
- **Provider ID:** `cloudflare-ai-gateway`
- **Default model:** `claude-sonnet-4-5` (200K context, 64K max tokens)
- **API format:** `anthropic-messages`
- **Base URL pattern:** `https://gateway.ai.cloudflare.com/v1/${accountId}/${gatewayId}/anthropic`
- **Env var:** `CLOUDFLARE_AI_GATEWAY_API_KEY` (your Anthropic API key)

Files added/modified (29 files, +663 lines):
- `src/agents/cloudflare-ai-gateway.ts` — Provider definition with `resolveCloudflareAiGatewayBaseUrl()`
- `src/agents/models-config.providers.ts` — Provider config builder integration
- `src/commands/onboard-auth.config-core.ts` — `applyCloudflareAiGatewayConfig()` and `applyCloudflareAiGatewayProviderConfig()`
- `src/commands/onboard-auth.credentials.ts` — `setCloudflareAiGatewayConfig()` credential storage
- `src/commands/auth-choice.apply.api-providers.ts` — Auth choice routing for `cloudflare-ai-gateway-api-key`
- `src/cli/program/register.onboard.ts` — CLI flags for `--cloudflare-ai-gateway-*`
- `src/commands/onboard-non-interactive.cloudflare-ai-gateway.test.ts` — 99 lines of test coverage
- `docs/providers/cloudflare-ai-gateway.md` — Setup documentation

See: https://developers.cloudflare.com/ai-gateway/
